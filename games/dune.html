<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <style>
        html, body { margin: 0; height: 100%; background: #000; overflow: hidden; font-family: sans-serif; color: #fff; }
        canvas { width: 100%; height: 100%; display: block; }

        /* Minimal Loader */
        #loader {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            background: #000;
            z-index: 10;
        }

        h1 { letter-spacing: 10px; font-weight: 300; margin-bottom: 10px; }
        
        #bar-bg { width: 200px; height: 2px; background: #333; }
        #bar-fill { width: 0%; height: 100%; background: #fff; transition: width 0.2s; }
        #pct { margin-top: 10px; font-size: 12px; opacity: 0.5; }
    </style>
</head>
<body>

    <div id="loader">
        <h1>DUNE</h1>
        <div id="bar-bg"><div id="bar-fill"></div></div>
        <div id="pct">0%</div>
    </div>

    <canvas id="u"></canvas>

    <script>
        let c = document.getElementById("u"), 
            fill = document.getElementById("bar-fill"), 
            txt = document.getElementById("pct"),
            ld = document.getElementById("loader");

        // Input Handling
        let h=0,down=()=>!h&&(h=1,c.dispatchEvent(new MouseEvent("mousedown",{bubbles:1,buttons:1}))),up=()=>h&&(h=0,c.dispatchEvent(new MouseEvent("mouseup",{bubbles:1})));
        addEventListener("keydown",e=>e.code=="Space"&&(e.preventDefault(),down()),{passive:0});
        addEventListener("keyup",e=>e.code=="Space"&&(e.preventDefault(),up()),{passive:0});

        let cfg = {
            dataUrl: "https://4texas4.github.io/curve-rush/Build/curve-rush.data",
            frameworkUrl: "https://4texas4.github.io/curve-rush/Build/curve-rush.framework.js",
            codeUrl: "https://4texas4.github.io/curve-rush/Build/curve-rush.wasm"
        };

        let s = document.createElement("script");
        s.src = "https://4texas4.github.io/curve-rush/Build/curve-rush.loader.js";
        s.onload = () => {
            createUnityInstance(c, cfg, (p) => {
                let progress = Math.round(p * 100);
                fill.style.width = progress + "%";
                txt.innerText = progress + "%";
            }).then(() => ld.style.display = "none").catch(alert);
        };
        document.body.appendChild(s);
    </script>
</body>
</html>
